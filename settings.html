<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>PRISM ‚Äì Settings</title>
  <link rel="stylesheet" href="styles.css" />
  <style>
    /* Light Mode Theme */
    body.light-mode {
      --bg-dark: #f8fafc;
      --bg-card: #e2e8f0;
      --bg-soft: #f1f5f9;
      --text-primary: #0f172a;
      --text-secondary: #475569;
      --glass-border: 1px solid rgba(0, 0, 0, 0.06);
    }

    body.light-mode .sidebar {
      background: linear-gradient(180deg, #f1f5f9, #e2e8f0);
      border-right: 1px solid rgba(0, 0, 0, 0.1);
    }

    body.light-mode .sidebar nav a {
      color: #475569;
    }

    body.light-mode .sidebar nav a:hover,
    body.light-mode .sidebar nav a.active {
      background: rgba(56, 189, 248, 0.15);
      color: #0284c7;
    }

    body.light-mode table {
      background: #ffffff;
      border: 1px solid #cbd5e1;
    }

    body.light-mode table thead {
      background: #f1f5f9;
      color: #0f172a;
    }

    body.light-mode table tbody tr:hover {
      background: #f8fafc;
    }

    body.light-mode .panel {
      background: #ffffff;
      border: 1px solid #cbd5e1;
    }

    body.light-mode .card {
      background: #ffffff;
      border: 1px solid #cbd5e1;
    }

    body.light-mode input[type="text"],
    body.light-mode input[type="email"],
    body.light-mode input[type="number"],
    body.light-mode select,
    body.light-mode textarea {
      background: #f8fafc;
      border: 1px solid #cbd5e1;
      color: #0f172a;
    }

    body.light-mode input[type="text"]:focus,
    body.light-mode input[type="email"]:focus,
    body.light-mode input[type="number"]:focus,
    body.light-mode select:focus,
    body.light-mode textarea:focus {
      border-color: #38bdf8;
      box-shadow: 0 0 0 2px rgba(56, 189, 248, 0.1);
    }

    /* Settings Styles */
    .settings-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 1.5rem;
    }

    .settings-panel {
      background: var(--bg-card);
      border: var(--glass-border);
      border-radius: 12px;
      padding: 1.5rem;
      transition: all 0.3s ease;
    }

    .settings-panel h3 {
      color: var(--accent-blue);
      font-size: 1.1rem;
      margin-bottom: 1.5rem;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .settings-panel h3::before {
      content: '';
      display: inline-block;
      width: 4px;
      height: 20px;
      background: var(--accent-blue);
      border-radius: 2px;
    }

    .setting-item {
      margin-bottom: 1.5rem;
    }

    .setting-item:last-child {
      margin-bottom: 0;
    }

    .setting-label {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 0.5rem;
    }

    .setting-label label {
      font-weight: 500;
      color: var(--text-primary);
    }

    .setting-label small {
      color: var(--text-secondary);
      font-size: 0.85rem;
    }

    input[type="text"],
    input[type="email"],
    input[type="number"],
    select,
    textarea {
      width: 100%;
      padding: 0.75rem;
      background: var(--bg-dark);
      border: 1px solid rgba(56, 189, 248, 0.3);
      border-radius: 8px;
      color: var(--text-primary);
      font-family: inherit;
      font-size: 0.95rem;
      transition: all 0.3s ease;
    }

    input[type="text"]:focus,
    input[type="email"]:focus,
    input[type="number"]:focus,
    select:focus,
    textarea:focus {
      border-color: var(--accent-blue);
      outline: none;
      box-shadow: 0 0 0 2px rgba(56, 189, 248, 0.1);
    }

    .toggle-switch {
      display: flex;
      align-items: center;
      gap: 0.75rem;
    }

    .switch {
      position: relative;
      display: inline-block;
      width: 50px;
      height: 28px;
    }

    .switch input {
      opacity: 0;
      width: 0;
      height: 0;
    }

    .slider {
      position: absolute;
      cursor: pointer;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: #ccc;
      transition: 0.3s;
      border-radius: 28px;
    }

    .slider:before {
      position: absolute;
      content: '';
      height: 22px;
      width: 22px;
      left: 3px;
      bottom: 3px;
      background-color: white;
      transition: 0.3s;
      border-radius: 50%;
    }

    input:checked + .slider {
      background-color: var(--accent-blue);
    }

    input:checked + .slider:before {
      transform: translateX(22px);
    }

    .theme-toggle {
      display: flex;
      gap: 1rem;
      margin-bottom: 1rem;
    }

    .theme-btn {
      flex: 1;
      padding: 0.75rem;
      border: 2px solid rgba(56, 189, 248, 0.3);
      background: var(--bg-dark);
      color: var(--text-primary);
      border-radius: 8px;
      cursor: pointer;
      font-weight: 500;
      transition: all 0.3s ease;
    }

    .theme-btn:hover {
      border-color: var(--accent-blue);
      background: rgba(56, 189, 248, 0.1);
    }

    .theme-btn.active {
      border-color: var(--accent-blue);
      background: var(--accent-blue);
      color: var(--bg-dark);
    }

    .btn-primary,
    .btn-secondary {
      padding: 0.75rem 1.5rem;
      border: none;
      border-radius: 8px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.3s ease;
      font-size: 0.95rem;
    }

    .btn-primary {
      background: var(--accent-blue);
      color: #000;
    }

    .btn-primary:hover {
      background: #06b6d4;
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(56, 189, 248, 0.3);
    }

    .btn-secondary {
      background: transparent;
      border: 1px solid var(--text-secondary);
      color: var(--text-secondary);
    }

    .btn-secondary:hover {
      border-color: var(--accent-blue);
      color: var(--accent-blue);
    }

    .button-group {
      display: flex;
      gap: 1rem;
      margin-top: 2rem;
    }

    .success-message {
      background: rgba(74, 222, 128, 0.1);
      border: 1px solid var(--accent-green);
      color: var(--accent-green);
      padding: 1rem;
      border-radius: 8px;
      margin-bottom: 1rem;
      display: none;
    }

    .info-box {
      background: rgba(56, 189, 248, 0.1);
      border-left: 3px solid var(--accent-blue);
      padding: 1rem;
      border-radius: 4px;
      margin-top: 1rem;
      font-size: 0.9rem;
      color: var(--text-secondary);
    }
  </style>
</head>
<body>

  <!-- Sidebar -->
  <aside class="sidebar">
    <h2>PRISM</h2>
    <nav>
      <a href="index.html">Dashboard</a>
      <a href="admin.html">Admin</a>
      <a href="alerts.html">Alerts</a>
      <a href="settings.html" class="active">Settings</a>
    </nav>
  </aside>

  <!-- MAIN CONTENT -->
  <div class="layout">

    <!-- Page Header -->
    <header class="topbar">
      <h1>Settings & Preferences</h1>
    </header>

    <!-- Success Message -->
    <div class="success-message" id="successMessage">
      ‚úì Settings saved successfully!
    </div>

    <!-- Theme Settings (Full Width) -->
    <section class="panel">
      <h2>Theme Settings</h2>
      <p style="margin-bottom: 1.5rem; color: var(--text-secondary);">Choose your preferred color theme</p>
      <div class="theme-toggle">
        <button class="theme-btn active" id="darkModeBtn" onclick="setTheme('dark')">
          üåô Dark Mode
        </button>
        <button class="theme-btn" id="lightModeBtn" onclick="setTheme('light')">
          ‚òÄÔ∏è Light Mode
        </button>
      </div>
    </section>

    <!-- Settings Grid -->
    <div class="settings-grid">

      <!-- System Settings -->
      <section class="settings-panel">
        <h3>System Settings</h3>

        <div class="setting-item">
          <div class="setting-label">
            <label>Language</label>
          </div>
          <select id="language">
            <option value="en">English</option>
            <option value="es">Spanish</option>
            <option value="fr">French</option>
            <option value="de">German</option>
            <option value="pt">Portuguese</option>
          </select>
        </div>

        <div class="setting-item">
          <div class="setting-label">
            <label>Date Format</label>
          </div>
          <select id="dateFormat">
            <option value="MM/DD/YYYY">MM/DD/YYYY</option>
            <option value="DD/MM/YYYY">DD/MM/YYYY</option>
            <option value="YYYY-MM-DD">YYYY-MM-DD</option>
          </select>
        </div>

        <div class="setting-item">
          <div class="setting-label">
            <label>Time Zone</label>
          </div>
          <select id="timezone">
            <option value="UTC">UTC</option>
            <option value="EST">EST</option>
            <option value="CST">CST</option>
            <option value="MST">MST</option>
            <option value="PST">PST</option>
            <option value="IST">IST</option>
          </select>
        </div>

        <div class="setting-item">
          <div class="setting-label">
            <label>Auto-refresh Data</label>
            <small>Minutes</small>
          </div>
          <input type="number" id="autoRefresh" min="1" max="60" value="5" />
        </div>
      </section>

      <!-- Notification Settings -->
      <section class="settings-panel">
        <h3>Notifications</h3>

        <div class="setting-item">
          <div class="setting-label">
            <label>Email Notifications</label>
          </div>
          <div class="toggle-switch">
            <label class="switch">
              <input type="checkbox" id="emailNotif" checked />
              <span class="slider"></span>
            </label>
            <span id="emailNotifLabel">Enabled</span>
          </div>
        </div>

        <div class="setting-item">
          <div class="setting-label">
            <label>Push Notifications</label>
          </div>
          <div class="toggle-switch">
            <label class="switch">
              <input type="checkbox" id="pushNotif" checked />
              <span class="slider"></span>
            </label>
            <span id="pushNotifLabel">Enabled</span>
          </div>
        </div>

        <div class="setting-item">
          <div class="setting-label">
            <label>Alert on High Priority</label>
          </div>
          <div class="toggle-switch">
            <label class="switch">
              <input type="checkbox" id="highPriorityAlert" checked />
              <span class="slider"></span>
            </label>
            <span id="highPriorityLabel">Enabled</span>
          </div>
        </div>

        <div class="setting-item">
          <div class="setting-label">
            <label>Daily Summary Report</label>
          </div>
          <div class="toggle-switch">
            <label class="switch">
              <input type="checkbox" id="dailySummary" checked />
              <span class="slider"></span>
            </label>
            <span id="dailySummaryLabel">Enabled</span>
          </div>
        </div>
      </section>

      <!-- Data Settings -->
      <section class="settings-panel">
        <h3>Data Management</h3>

        <div class="setting-item">
          <div class="setting-label">
            <label>Data Retention Period</label>
            <small>Days</small>
          </div>
          <input type="number" id="retentionDays" min="7" max="365" value="90" />
        </div>

        <div class="setting-item">
          <div class="setting-label">
            <label>Records per Page</label>
          </div>
          <select id="recordsPerPage">
            <option value="10">10</option>
            <option value="25" selected>25</option>
            <option value="50">50</option>
            <option value="100">100</option>
          </select>
        </div>

        <div class="setting-item">
          <div class="setting-label">
            <label>Auto Export Logs</label>
          </div>
          <div class="toggle-switch">
            <label class="switch">
              <input type="checkbox" id="autoExport" />
              <span class="slider"></span>
            </label>
            <span id="autoExportLabel">Disabled</span>
          </div>
        </div>

        <div class="setting-item">
          <div class="setting-label">
            <label>Export Format</label>
          </div>
          <select id="exportFormat">
            <option value="csv">CSV</option>
            <option value="json">JSON</option>
            <option value="excel">Excel</option>
          </select>
        </div>
      </section>

      <!-- Security Settings -->
      <section class="settings-panel">
        <h3>Security</h3>

        <div class="setting-item">
          <div class="setting-label">
            <label>Session Timeout</label>
            <small>Minutes</small>
          </div>
          <input type="number" id="sessionTimeout" min="5" max="480" value="30" />
        </div>

        <div class="setting-item">
          <div class="setting-label">
            <label>Two-Factor Authentication</label>
          </div>
          <div class="toggle-switch">
            <label class="switch">
              <input type="checkbox" id="twoFactorAuth" />
              <span class="slider"></span>
            </label>
            <span id="twoFactorLabel">Disabled</span>
          </div>
        </div>

        <div class="setting-item">
          <div class="setting-label">
            <label>Login Notifications</label>
          </div>
          <div class="toggle-switch">
            <label class="switch">
              <input type="checkbox" id="loginNotif" checked />
              <span class="slider"></span>
            </label>
            <span id="loginNotifLabel">Enabled</span>
          </div>
        </div>

        <div class="setting-item">
          <div class="setting-label">
            <label>IP Whitelist</label>
          </div>
          <input type="text" id="ipWhitelist" placeholder="Enter IP addresses (comma separated)" />
        </div>
      </section>

      <!-- User Profile -->
      <section class="settings-panel">
        <h3>User Profile</h3>

        <div class="setting-item">
          <div class="setting-label">
            <label>Full Name</label>
          </div>
          <input type="text" id="fullName" placeholder="Your full name" />
        </div>

        <div class="setting-item">
          <div class="setting-label">
            <label>Email</label>
          </div>
          <input type="email" id="email" placeholder="your.email@example.com" />
        </div>

        <div class="setting-item">
          <div class="setting-label">
            <label>Department</label>
          </div>
          <input type="text" id="department" placeholder="Your department" />
        </div>

        <div class="setting-item">
          <div class="setting-label">
            <label>Role</label>
          </div>
          <select id="role">
            <option value="admin">Administrator</option>
            <option value="analyst">Analyst</option>
            <option value="reviewer">Reviewer</option>
            <option value="viewer">Viewer</option>
          </select>
        </div>
      </section>

      <!-- API Settings -->
      <section class="settings-panel">
        <h3>API Settings</h3>

        <div class="setting-item">
          <div class="setting-label">
            <label>API Endpoint</label>
          </div>
          <input type="text" id="apiEndpoint" placeholder="https://api.example.com" value="http://localhost:5000" />
        </div>

        <div class="setting-item">
          <div class="setting-label">
            <label>Request Timeout</label>
            <small>Seconds</small>
          </div>
          <input type="number" id="requestTimeout" min="5" max="60" value="30" />
        </div>

        <div class="setting-item">
          <div class="setting-label">
            <label>Retry Failed Requests</label>
          </div>
          <div class="toggle-switch">
            <label class="switch">
              <input type="checkbox" id="retryRequests" checked />
              <span class="slider"></span>
            </label>
            <span id="retryLabel">Enabled</span>
          </div>
        </div>

        <div class="setting-item">
          <div class="setting-label">
            <label>Max Retries</label>
          </div>
          <input type="number" id="maxRetries" min="1" max="10" value="3" />
        </div>
      </section>

    </div>

    <!-- Action Buttons -->
    <div class="button-group">
      <button class="btn-primary" id="saveBtn">üíæ Save Settings</button>
      <button class="btn-secondary" id="resetBtn">‚Üª Reset to Default</button>
      <button class="btn-secondary" id="exportBtn">üì• Export Settings</button>
    </div>

    <!-- Info Box -->
    <div class="info-box">
      üí° <strong>Tip:</strong> Your settings are automatically saved to your browser's local storage. They will persist across sessions.
    </div>

    <!-- Footer -->
    <footer>
      PRISM Settings & Preferences ‚Ä¢ Last Modified: <span id="lastModified">--:--</span>
    </footer>

  </div>

  <script src="ui.js"></script>
  <script>
    // Initialize Theme
    function initializeSettingsTheme() {
      const savedTheme = localStorage.getItem('theme') || 'dark';
      setTheme(savedTheme);
    }
    
    // Toggle Switch Labels
    document.addEventListener('change', function(e) {
      if (e.target.type === 'checkbox') {
        const labels = {
          'emailNotif': 'emailNotifLabel',
          'pushNotif': 'pushNotifLabel',
          'highPriorityAlert': 'highPriorityLabel',
          'dailySummary': 'dailySummaryLabel',
          'autoExport': 'autoExportLabel',
          'twoFactorAuth': 'twoFactorLabel',
          'loginNotif': 'loginNotifLabel',
          'retryRequests': 'retryLabel'
        };
        
        if (labels[e.target.id]) {
          const labelEl = document.getElementById(labels[e.target.id]);
          labelEl.textContent = e.target.checked ? 'Enabled' : 'Disabled';
        }
      }
    });

    // Load Settings from localStorage
    function loadSettings() {
      const settings = JSON.parse(localStorage.getItem('prismSettings')) || {};
      
      Object.keys(settings).forEach(key => {
        const element = document.getElementById(key);
        if (element) {
          if (element.type === 'checkbox') {
            element.checked = settings[key];
          } else {
            element.value = settings[key];
          }
        }
      });
    }

    // Save Settings
    document.getElementById('saveBtn').addEventListener('click', function() {
      const settings = {};
      
      // Collect all input values
      document.querySelectorAll('input, select').forEach(el => {
        if (el.id) {
          if (el.type === 'checkbox') {
            settings[el.id] = el.checked;
          } else {
            settings[el.id] = el.value;
          }
        }
      });
      
      localStorage.setItem('prismSettings', JSON.stringify(settings));
      
      // Show success message
      const successMsg = document.getElementById('successMessage');
      successMsg.style.display = 'block';
      document.getElementById('lastModified').textContent = new Date().toLocaleTimeString();
      
      setTimeout(() => {
        successMsg.style.display = 'none';
      }, 3000);
    });

    // Reset to Default
    document.getElementById('resetBtn').addEventListener('click', function() {
      if (confirm('Are you sure you want to reset all settings to default?')) {
        localStorage.removeItem('prismSettings');
        location.reload();
      }
    });

    // Export Settings
    document.getElementById('exportBtn').addEventListener('click', function() {
      const settings = localStorage.getItem('prismSettings');
      const dataStr = "data:text/json;charset=utf-8," + encodeURIComponent(settings);
      const downloadAnchor = document.createElement('a');
      downloadAnchor.setAttribute("href", dataStr);
      downloadAnchor.setAttribute("download", `prism_settings_${Date.now()}.json`);
      document.body.appendChild(downloadAnchor);
      downloadAnchor.click();
      downloadAnchor.remove();
    });

    // Initialize
    document.addEventListener('DOMContentLoaded', function() {
      console.log("Settings page loading...");
      initializeSettingsTheme();
      loadSettings();
      document.getElementById('lastModified').textContent = new Date().toLocaleTimeString();
    });
  </script>

</body>
</html>
